% JobHunter07 Pandoc LaTeX template
% Complete implementation of JobHunter07 brand identity
% Supports title page, TOC, chapters, headers/footers, images, and version injection

\documentclass[11pt, a4paper]{memoir}

% ========== PREAMBLE ==========

% Encoding and microtypography
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{microtype}

% Colors (brand palette)
\usepackage{xcolor}
\definecolor{moss}{HTML}{2F3E2C}
\definecolor{fog}{HTML}{D9D9D6}
\definecolor{woodland}{HTML}{5A4632}
\definecolor{compass}{HTML}{C98A2E}
\definecolor{shadow}{HTML}{1A1A1A}
\definecolor{mist}{HTML}{F5F5F2}

% Page geometry
\usepackage[inner=3cm,outer=3cm,top=2.5cm,bottom=2.5cm]{geometry}

% Fonts
\usepackage{ifxetex,ifluatex}
\ifxetex
  \usepackage{fontspec}
  \setmainfont{Calibri}
  \setsansfont{Calibri}
\else\ifluatex
  \usepackage{fontspec}
  \setmainfont{Calibri}
  \setsansfont{Calibri}
\else
  \usepackage{mathptmx}
\fi\fi

% Graphics and layout
\usepackage{graphicx}
\usepackage{tikz}
\usepackage{eso-pic}
\usetikzlibrary{shadows,shapes,calc}
\usepackage[most]{tcolorbox}
\tcbuselibrary{breakable}
\usepackage[hidelinks]{hyperref}

% Headers and footers
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\renewcommand{\headrulewidth}{0pt}

% Table of contents (loaded BEFORE titlesec)
\usepackage{tocloft}
\setcounter{tocdepth}{2}
\renewcommand{\contentsname}{Contents}

% Section styling
\usepackage{titlesec}
\titleformat{\chapter}[display]
  {\normalfont\Huge\bfseries\sffamily\color{moss}}{\filleft\large\color{compass}\raisebox{-1ex}{\thechapter}}{0pt}{\Huge}
\titleformat{\section}{\normalfont\Large\bfseries\sffamily\color{moss}}{\thesection}{1em}{}
\titleformat{\subsection}{\normalfont\large\bfseries\sffamily\color{woodland}}{\thesubsection}{1em}{}

% ========== MACROS AND COMMANDS ==========

% Compass watermark
\newcommand{\compassWatermark}[1]{%
  \AddToShipoutPictureBG*{%
    \AtPageCenter{%
      \begin{tikzpicture}[opacity=0.06]
        \draw[draw=shadow!70, line width=0.6pt] (0,0) circle (#1*0.5);
        \foreach \a in {0,90,180,270} {\draw[draw=shadow!70] (\a:#1*0.45) -- (\a:#1*0.5);}
        \node[font=\sffamily\small, color=shadow!60] at (0, #1*0.55) {N};
        \node[font=\sffamily\small, color=shadow!60] at (0, -#1*0.55) {S};
        \node[font=\sffamily\small, color=shadow!60] at (#1*0.55,0) {E};
        \node[font=\sffamily\small, color=shadow!60] at (-#1*0.55,0) {W};
        \path[draw=compass, line width=1pt, rotate=15] (0,0) -- (0,#1*0.45);
      \end{tikzpicture}
    }
  }
}

% Footprint separator
\newcommand{\footprintSeparator}{%
  \par\vspace{0.8\baselineskip}
  \noindent\centering{\tikz[baseline] { \draw[draw=woodland, line width=0.8pt, dash pattern=on 0.5pt off 2pt] (0,0) -- (3cm,0); \foreach \x in {0.3,0.9,1.5,2.1,2.7} { \fill[woodland] (\x,0) circle (0.035cm);} }}\par
  \vspace{0.8\baselineskip}
}

% Fog gradient
\newcommand{\topFog}{%
  \AddToShipoutPictureBG*{%
    \AtPageUpperLeft{%
      \begin{tikzpicture}[remember picture, overlay]
        \shade[left color=white, right color=white, bottom color=white, top color=fog] (0,0) rectangle (\paperwidth,-3cm);
      \end{tikzpicture}
    }
  }
}

% Trail rule
\newcommand{\trailrule}{%
  \vspace{0.5\baselineskip}
  \noindent{\color{moss}\rule{\linewidth}{0.6pt}}\par
  \vspace{0.5\baselineskip}
}

% Callout boxes
\newtcolorbox{hunttip}[2][]{colback=fog!80,colframe=woodland!80,coltext=shadow,arc=2mm,boxrule=0.6pt,left=6pt,right=6pt,top=6pt,bottom=6pt,title=#2,#1}

% Pull quotes
\newcommand{\pullquote}[1]{%
  \begin{center}\noindent\begin{tcolorbox}[colback=mist,colframe=woodland!60,width=0.8\textwidth,boxrule=0.4pt,arc=2mm]\sffamily\color{woodland}\large#1\end{tcolorbox}\end{center}%
}

% ========== TITLE PAGE COMMAND ==========

% Simple, clean title page without background image (background removed by request)
\newcommand{\maketitlepage}{%
  \thispagestyle{empty}
  \begingroup
  \vspace*{3cm}
  \begin{center}
    $if(logo)$
      \IfFileExists{$logo$}{\includegraphics[height=2.2cm]{$logo$}\\[0.8em]}{}
    $endif$
    {\sffamily\Huge\color{moss}\JobHunterTitle\\[0.6em]}
    $if(subtitle)$
      {\sffamily\Large\color{woodland}\JobHunterSubtitle\\[0.6em]}
    $endif$
    {\sffamily\Large\color{woodland}Version: \JobHunterVersion\\[0.8em]}
    $if(author)$
      {\sffamily\large\color{shadow}\JobHunterAuthor\\[0.4em]}
    $endif$
    $if(date)$
      {\sffamily\small\color{shadow}\JobHunterDate\\[1em]}
    $endif$
  \end{center}
  \endgroup
  \clearpage
}

% ========== PANDOC VARIABLES ==========

\newcommand{\JobHunterTitle}{JobHunter07}
\newcommand{\JobHunterSubtitle}{}
\newcommand{\JobHunterAuthor}{}
\newcommand{\JobHunterDate}{}
\newcommand{\JobHunterVersion}{0.1}

$if(title)$
  \renewcommand{\JobHunterTitle}{$title$}
$endif$
$if(subtitle)$
  \renewcommand{\JobHunterSubtitle}{$subtitle$}
$endif$
$if(author)$
  \renewcommand{\JobHunterAuthor}{$author$}
$endif$
$if(date)$
  \renewcommand{\JobHunterDate}{$date$}
$endif$
$if(version)$
  \renewcommand{\JobHunterVersion}{$version$}
$endif$

% ========== FOOTER AND TOC STYLING ==========

\fancyfoot[LE]{\color{fog}\thepage}
\fancyfoot[RO]{\color{fog}\thepage}
\fancyfoot[RE,LO]{\color{shadow}\JobHunterVersion}

% Image defaults
\setlength{\intextsep}{10pt}
\setkeys{Gin}{width=0.9\linewidth,keepaspectratio}

% ========== DOCUMENT ==========

\begin{document}

\maketitlepage

\clearpage
\topFog
\tableofcontents
\clearpage

$for(include-before)$
$include-before$
$endfor$

$body$

% Footer silhouette
\AddToShipoutPicture{%
  \AtPageLowerLeft{%
    \begin{tikzpicture}[remember picture, overlay]
      \begin{scope}[shift={(0cm,0cm)},opacity=0.04]
        \draw[fill=shadow!10, draw=none] (0,0) -- (1.5cm,0.6cm) -- (3.2cm,0.2cm) -- (5cm,0.8cm) -- (\paperwidth,0) -- (\paperwidth, -1cm) -- (0,-1cm) -- cycle;
      \end{scope}
    \end{tikzpicture}
  }
}

\end{document}
